import{u as y,r as a,j as e,S as M}from"./index-BzL6lTip.js";import{a as C}from"./priceService-mbjv3pkS.js";const V=({setPage:W})=>{const{language:S}=y(),[o,f]=a.useState([]),[j,x]=a.useState(!0),[i,v]=a.useState("all"),[r,b]=a.useState(null),[s,w]=a.useState(null);a.useEffect(()=>{N()},[]);const N=async()=>{x(!0);try{const t=await C();f(t)}catch(t){console.error("Error loading warehouses:",t)}finally{x(!1)}},k=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{w({lat:t.coords.latitude,lng:t.coords.longitude})},t=>{console.error("Error getting location:",t),alert("خطا در دریافت موقعیت مکانی. لطفا دسترسی به موقعیت مکانی را فعال کنید.")}):alert("مرورگر شما از موقعیت‌یابی پشتیبانی نمی‌کند.")},L=["all",...new Set(o.map(t=>t.city_fa).filter(Boolean))],m=i==="all"?o:o.filter(t=>t.city_fa===i),d=(t,l,n,c)=>{const u=(n-t)*Math.PI/180,g=(c-l)*Math.PI/180,p=Math.sin(u/2)*Math.sin(u/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(g/2)*Math.sin(g/2);return 6371*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},h=s?[...m].sort((t,l)=>{const n=t.latitude&&t.longitude?d(s.lat,s.lng,t.latitude,t.longitude):1/0,c=l.latitude&&l.longitude?d(s.lat,s.lng,l.latitude,l.longitude):1/0;return n-c}):m;return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(M,{title:"یافتن انبار آهن - نقشه انبارها",description:"یافتن نزدیک‌ترین انبار آهن و فولاد به موقعیت شما. لیست انبارهای معتبر در سراسر ایران.",keywords:"انبار آهن, بازار آهن, شادآباد, انبار میلگرد, انبار تیرآهن"}),e.jsx("section",{className:"bg-gradient-to-br from-corp-blue-dark to-corp-blue text-white py-16",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsxs("h1",{className:"text-4xl font-extrabold mb-4 flex items-center gap-3",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"یافتن انبار آهن"]}),e.jsx("p",{className:"text-lg text-blue-100",children:"نزدیک‌ترین انبار آهن و فولاد را به موقعیت خود پیدا کنید. لیست انبارهای معتبر در سراسر ایران."})]})})}),e.jsx("section",{className:"py-12 bg-slate-50",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 sticky top-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"فیلتر بر اساس شهر"}),e.jsxs("select",{value:i,onChange:t=>v(t.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corp-blue focus:border-transparent text-right",children:[e.jsx("option",{value:"all",children:"همه شهرها"}),L.filter(t=>t!=="all").map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("button",{onClick:k,className:"w-full px-4 py-3 bg-corp-blue text-white font-bold rounded-lg hover:bg-corp-blue-dark transition-colors flex items-center justify-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"یافتن نزدیک‌ترین انبار"]}),s&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-700 flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"موقعیت شما دریافت شد"]})}),e.jsx("div",{className:"border-t border-slate-200 pt-4",children:e.jsxs("p",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-bold",children:h.length})," انبار یافت شد"]})})]})})}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"bg-slate-200 rounded-xl overflow-hidden mb-6",style:{height:"400px"},children:e.jsx("iframe",{src:`https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d6478.5!2d51.35!3d35.65!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2z${r?`${r.latitude},${r.longitude}`:"35.65,51.35"}!5e0!3m2!1sen!2s!4v1653842628435!5m2!1sen!2s`,className:"w-full h-full border-0",allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",title:"نقشه انبارها"})}),j?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-corp-blue rounded-full animate-spin"}),e.jsx("span",{className:"mr-3 text-slate-600",children:"در حال بارگذاری..."})]}):e.jsx("div",{className:"space-y-4",children:h.map(t=>{const l=s&&t.latitude&&t.longitude?d(s.lat,s.lng,t.latitude,t.longitude):null;return e.jsx("div",{className:`bg-white rounded-xl shadow-sm border-2 p-6 cursor-pointer transition-all hover:shadow-lg ${(r==null?void 0:r.id)===t.id?"border-corp-blue":"border-slate-200 hover:border-slate-300"}`,onClick:()=>b(t),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-corp-blue/10 text-corp-blue flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-900",children:t.name_fa}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:t.city_fa}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:t.address_fa}),t.phone&&e.jsxs("a",{href:`tel:${t.phone}`,className:"inline-flex items-center gap-1 text-corp-blue font-medium text-sm mt-2 hover:underline",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.phone]})]})]}),e.jsxs("div",{className:"text-left",children:[l!==null&&e.jsxs("div",{className:"bg-green-100 text-green-700 px-3 py-1.5 rounded-full text-sm font-medium",children:[l.toFixed(1)," کیلومتر"]}),t.latitude&&t.longitude&&e.jsxs("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${t.latitude},${t.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-corp-blue text-sm font-medium mt-2 hover:underline",onClick:n=>n.stopPropagation(),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"مسیریابی"]})]})]})},t.id)})})]})]})})})]})};export{V as default};
